import{u as w,b as A,r as N,Q as l,j as e,_ as P,d as b,y as D}from"./index-4820e760.js";import{s as E}from"./slugify-796ef179.js";import{R as n}from"./Radio-6d0d2374.js";import{c as O,a as R,u as S,F as u,L as m,I as V,b as C,o as F}from"./yup-7563acd1.js";import{H}from"./Heading-03f78f57.js";import{B as k}from"./Button-f45348c8.js";import{u as h,c as a}from"./constants-c6ed1daf.js";const L=O({title:R().required("Please enter your title !")}),q=()=>{const{userInfo:s}=w(),{control:r,handleSubmit:g,watch:p,reset:x,formState:{isValid:f,isSubmitting:i,errors:d}}=S({mode:"onchange",resolver:F(L),defaultValues:{title:"",slug:"",status:"pending",createdAt:new Date}}),c=p("status"),j=A(),y=async o=>{if(f)try{const t={...o};t.slug=E(t.title,{lower:!0});const v=P(b,"categories");await D(v,{...t,createdAt:new Date}),j("/manage/category"),l.success("Add new category successfully !",{theme:"colored",autoClose:2e3,pauseOnHover:!1}),x({title:"",slug:"",status:"pending",createdAt:new Date})}catch{l.error("Failed to add new category !",{theme:"colored",autoClose:2e3,pauseOnHover:!1})}};return N.useEffect(()=>{var t;const o=Object.values(d);o.length>0&&l.error((t=o[0])==null?void 0:t.message,{theme:"colored",autoClose:2e3,pauseOnHover:!1})},[d]),e.jsxs("div",{children:[e.jsx(H,{children:"add new category"}),e.jsxs("form",{className:"pt-14",onSubmit:g(y),children:[e.jsxs("div",{className:"grid gap-10 mb-10 lg:grid-cols-2",children:[e.jsxs(u,{children:[e.jsx(m,{children:"Title ‚úíÔ∏è"}),e.jsx(V,{control:r,placeholder:"Enter your title",name:"title"})]}),((s==null?void 0:s.role)===h.ADMIN||(s==null?void 0:s.role)===h.MOD)&&e.jsx(e.Fragment,{children:e.jsxs(u,{children:[e.jsx(m,{children:"Status üìâ"}),e.jsxs("div",{className:"flex items-center gap-x-5",children:[e.jsx(n,{name:"status",control:r,checked:c===a.APPROVED,value:a.APPROVED,children:"Approved"}),e.jsx(n,{name:"status",control:r,checked:c===a.PENDING,value:a.PENDING,children:"Pending"}),e.jsx(n,{name:"status",control:r,checked:c===a.UNAPPROVED,value:a.UNAPPROVED,children:"Unapproved"})]})]})})]}),e.jsx(k,{type:"submit",kind:"secondary",className:`w-[250px] mx-auto h-[65px] font-semibold text-xl ${i?"opacity-50 pointer-events-none":""}`,children:i?e.jsx(C,{}):"add new category"})]})]})};export{q as default};
