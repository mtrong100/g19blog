import{j as e,u as N,r as c,b as D,_ as k,d as j,p as A,m as S,g as U,Q as C}from"./index-f4999a5f.js";import{T as M,I as R,a as E}from"./IconDelete-29764fae.js";import{S as g}from"./sweetalert2.all-b21a6cf2.js";import{P as h,B as T}from"./Button-2a8f4be9.js";import{I as B}from"./IconView-b6b0e2c0.js";import{H as P}from"./Heading-dd06bb81.js";import{u as a}from"./constants-c6ed1daf.js";import{b as I}from"./data-36aedd86.js";import{A as O}from"./index.esm-45f7dd71.js";import{v as L}from"./v4-a960c1f4.js";const d=({children:t,type:x=""})=>{let r="";switch(x){case"admin":r="bg-colorGradient";break;case"mod":r="bg-colorGradient2";break;case"user":r="bg-colorDark2";break}return e.jsx("span",{className:`${r} hover:opacity-90 select-none inline-block px-[15px] w-[100px] text-center rounded-lg font-semibold text-sm py-[10px]`,children:t})};d.propTypes={children:h.node,type:h.string.isRequired,typeStyles:h.string};const K=()=>{const{userInfo:t}=N(),[x,r]=c.useState([]),m=D(),[u,b]=c.useState(""),[p,y]=c.useState("all");c.useEffect(()=>{((t==null?void 0:t.role)===a.USER||(t==null?void 0:t.role)===a.MOD)&&m(`/manage/update-user?id=${t.uid}`)},[m,t==null?void 0:t.role,t.uid]);const w=s=>{switch(s){case a.ADMIN:return e.jsx(d,{type:"admin",children:"Admin"});case a.MOD:return e.jsx(d,{type:"mod",children:"Mod"});case a.USER:return e.jsx(d,{type:"user",children:"User"})}};c.useEffect(()=>{async function s(){const l=k(j,"users");A(l,o=>{let n=[];o.forEach(i=>{n.push({id:i.id,...i.data()})}),r(n)})}s()},[]);const f=x.filter(s=>s.username.toLowerCase().includes(u.toLowerCase())).filter(s=>p==="all"?!0:s.role===p),v=async s=>{const l=S(j,"users",s);t.role===a.ADMIN?g.fire({title:"Are you sure you want to delete this user?",text:"This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes"}).then(async o=>{o.isConfirmed&&(await U(l),await g.fire("Deleted!","User has been deleted.","success"))}):C.error("only ADMIN can delete users !",{theme:"colored",autoClose:2e3,pauseOnHover:!1})};return e.jsxs(e.Fragment,{children:[e.jsx(P,{children:"users manage"}),e.jsxs("div",{className:"flex justify-between py-10",children:[e.jsx(T,{type:"button",kind:"secondary",className:"h-[55px]",path:"/manage/add-user",children:"Add new user"}),e.jsxs("div",{className:"flex items-center gap-10",children:[e.jsxs("select",{className:"py-2 w-[150px] text-lg border border-solid rounded bg-colorDime border-colorPink",value:p,onChange:s=>y(s.target.value),children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:a.ADMIN,children:"Admin"}),e.jsx("option",{value:a.MOD,children:"Mod"}),e.jsx("option",{value:a.USER,children:"User"})]}),e.jsxs("div",{className:"w-full flex items-center py-4 px-5 gap-3 max-w-[300px] border-2 border-solid rounded-full border-colorPink",children:[e.jsx("span",{className:"text-2xl",children:e.jsx(O,{})}),e.jsx("input",{value:u,onChange:s=>b(s.target.value),type:"text",className:"w-full",placeholder:"Search user..."})]})]})]}),e.jsxs(M,{children:[e.jsx("thead",{children:e.jsx("tr",{children:I.map(s=>e.jsx("th",{children:s},L()))})}),e.jsx("tbody",{children:f.length>0&&f.map(s=>{var n,i;const l=(n=s==null?void 0:s.createdAt)!=null&&n.seconds?new Date(((i=s==null?void 0:s.createdAt)==null?void 0:i.seconds)*1e3):new Date,o=new Date(l).toLocaleDateString("vi-VI");return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsx("div",{className:"w-[60px] h-[60px] rounded-full",children:e.jsx("img",{src:s.avatar,alt:"",className:"rounded-full imgCover"})}),e.jsxs("div",{className:"flex-col flex-1 gap-3 whitespace-pre-wrap",children:[e.jsx("h3",{className:"font-semibold text-sm hover:opacity-90 mb-1 max-w-[300px] capitalize  leading-relaxed",children:s.username}),e.jsx("time",{className:"text-sm font-bold text-gray-500",children:`Date: ${o}`})]})]})}),e.jsx("td",{className:"overflow-x-hidden",children:e.jsx("span",{className:"inline-block px-4 py-3 text-sm font-semibold text-center rounded-lg w-fit hover:opacity-90 bg-colorDark text-colorPink ",children:s.email})}),e.jsx("td",{children:e.jsx("span",{className:"inline-block px-4 py-3 text-sm font-semibold text-center rounded-lg w-fit hover:opacity-90 bg-colorDark text-colorGreen ",children:s.password})}),e.jsx("td",{children:w(s.role)}),e.jsx("td",{children:e.jsxs("div",{className:"flex items-center text-gray-500 gap-x-3",children:[e.jsx(B,{}),e.jsx(R,{onClick:()=>m(`/manage/update-user?id=${s.id}`)}),e.jsx(E,{onClick:()=>v(s.id)})]})})]},s.id)})})]})]})};export{K as default};
