import{u as A,b as R,r as d,Q as g,_ as b,R as S,P as k,p as v,j as e,d as h,m as I,g as T}from"./index-8383c646.js";import{T as B,I as L,a as O}from"./IconDelete-a41cb1a3.js";import{S as w}from"./sweetalert2.all-c2f2a56b.js";import{L as m}from"./LabelStatus-fd320dd6.js";import{I as H}from"./IconView-c80c4c04.js";import{H as V}from"./Heading-9c7aef46.js";import{B as z}from"./Button-7ea5bd85.js";import{t as M}from"./data-3a117f56.js";import{u as y,p as o}from"./constants-c6ed1daf.js";import{A as Q}from"./index.esm-8b0e7de9.js";import{v as U}from"./v4-a960c1f4.js";const te=()=>{const{userInfo:s}=A(),x=R(),[N,p]=d.useState([]),[f,D]=d.useState(""),[u,P]=d.useState("all");d.useEffect(()=>{window.innerWidth<=768&&(x("/"),g.error("Not available for mobile and tablet  !",{theme:"colored",autoClose:2e3,pauseOnHover:!1}))},[x]);const E=t=>{switch(t){case o.APPROVED:return e.jsx(m,{type:"success",children:"Approved"});case o.PENDING:return e.jsx(m,{type:"warning",children:"Pending"});case o.REJECTED:return e.jsx(m,{type:"danger",children:"Rejected"})}};d.useEffect(()=>{(s==null?void 0:s.role)===y.USER?t():i();async function t(){if(!s.uid)return;const n=b(h,"posts"),l=S(n,k("user.id","==",s.uid));v(l,a=>{const r=[];a.forEach(c=>{r.push({id:c.id,...c.data()}),p(r)})})}async function i(){const n=b(h,"posts");v(n,l=>{let a=[];l.forEach(r=>{a.push({id:r.id,...r.data()})}),p(a)})}},[s==null?void 0:s.role,s.uid]);const j=N.filter(t=>t.title.toLowerCase().includes(f.toLowerCase())).filter(t=>u==="all"?!0:t.status===u),C=async t=>{const i=I(h,"posts",t);s.role===y.ADMIN?w.fire({title:"Are you sure you want to delete this user?",text:"This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes"}).then(async n=>{n.isConfirmed&&(await T(i),await w.fire("Deleted!","User has been deleted.","success"))}):g.error("only ADMIN can delete posts !",{theme:"colored",autoClose:2e3,pauseOnHover:!1})};return e.jsxs(e.Fragment,{children:[e.jsx(V,{children:"posts manage"}),e.jsxs("div",{className:"flex justify-between py-10",children:[e.jsx(z,{type:"button",kind:"secondary",className:"h-[55px]",path:"/manage/add-post",children:"Add new post"}),e.jsxs("div",{className:"flex items-center gap-10",children:[e.jsxs("select",{className:"py-2 w-[150px] text-lg border border-solid rounded bg-colorDime border-colorPink",value:u,onChange:t=>P(t.target.value),children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:o.APPROVED,children:"Approved"}),e.jsx("option",{value:o.PENDING,children:"Pending"}),e.jsx("option",{value:o.REJECTED,children:"Rejected"})]}),e.jsxs("div",{className:"w-full flex items-center py-4 px-5 gap-3 max-w-[300px] border-2 border-solid rounded-full border-colorPink",children:[e.jsx("span",{className:"text-2xl",children:e.jsx(Q,{})}),e.jsx("input",{value:f,onChange:t=>D(t.target.value),type:"text",className:"w-full",placeholder:"Search post..."})]})]})]}),e.jsxs(B,{children:[e.jsx("thead",{children:e.jsx("tr",{children:M.map(t=>e.jsx("th",{children:t},U()))})}),e.jsx("tbody",{children:j.length>0&&j.map(t=>{var r,c;const i=(r=t==null?void 0:t.createdAt)!=null&&r.seconds?new Date(((c=t==null?void 0:t.createdAt)==null?void 0:c.seconds)*1e3):new Date,n=new Date(i).toLocaleDateString("vi-VI"),{user:l,category:a}=t;return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:"flex items-center gap-x-3",children:[e.jsx("img",{src:t.image,alt:"",className:"w-[100px] select-none h-[80px] rounded object-cover"}),e.jsxs("div",{className:"flex-1 whitespace-pre-wrap",children:[e.jsx("h3",{className:"font-semibold hover:opacity-90 mb-1 max-w-[300px] capitalize  leading-relaxed",children:t.title}),e.jsx("time",{className:"text-sm font-bold text-gray-500",children:`Date: ${n}`})]})]})}),e.jsx("td",{children:e.jsx("span",{className:"hover:opacity-90 italic capitalize select-none inline-block px-[15px] w-[100px] text-center rounded-lg font-semibold bg-colorDark text-colorPink text-sm py-[10px]",children:a==null?void 0:a.title})}),e.jsx("td",{children:e.jsx("span",{className:"font-semibold text-gray-500 capitalize",children:l==null?void 0:l.username})}),e.jsx("td",{children:E(t.status)}),e.jsx("td",{children:e.jsxs("div",{className:"flex items-center text-gray-500 gap-x-3",children:[e.jsx(H,{onClick:()=>x(`/${t.slug}`)}),e.jsx(L,{onClick:()=>x(`/manage/update-post?id=${t.id}`)}),e.jsx(O,{onClick:()=>C(t.id)})]})})]},t.id)})})]})]})};export{te as default};
