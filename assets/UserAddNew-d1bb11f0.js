import{u as R,r as x,Q as m,j as e,i as U,a as S,y as D,_ as O,d as k,K as F}from"./index-4820e760.js";import{u as H,I as L}from"./ImageUpload-9bb7eaa7.js";import{s as P}from"./slugify-796ef179.js";import{R as c}from"./Radio-6d0d2374.js";import{c as C,a as t,u as M,F as l,L as o,I as d,b as V,o as q}from"./yup-7563acd1.js";import{H as B}from"./Heading-03f78f57.js";import{B as $}from"./Button-f45348c8.js";import{u as a}from"./constants-c6ed1daf.js";import"./index.esm-5e753448.js";const G=C({username:t().required("Please enter your username"),slug:t().lowercase(),email:t().lowercase().email("Please enter valid email").required("Please enter your email"),password:t().min(8,"Your password must be 8 characters or greater").required("Please enter your password")}),Z=()=>{R();const{control:r,handleSubmit:g,watch:j,setValue:f,getValues:w,reset:b,formState:{isValid:y,isSubmitting:u,errors:h}}=M({mode:"onchange",resolver:q(G),defaultValues:{email:"",password:"",username:"",avatar:"",slug:"",role:a.USER,createtAt:new Date}}),n=j("role"),{image:p,progress:E,handleSelectImage:v,handleDeleteImage:N,handleResetUpLoad:A}=H(f,w);x.useEffect(()=>{document.title="G19BLOG - Add New User"},[]);const I=async s=>{if(y)try{await U(S,s.email,s.password),await D(O(k,"users"),{username:s.username,email:s.email,password:s.password,slug:P(s.slug||s.username,{lower:!0}),role:s.role,avatar:p,createtAt:F()}),m.success("Add new user successfully !",{theme:"colored",autoClose:2e3,pauseOnHover:!1}),b({email:"",password:"",username:"",avatar:"",slug:"",role:a.USER,createtAt:new Date}),A()}catch{m.error("Failed to add new user !",{theme:"colored",autoClose:2e3,pauseOnHover:!1})}};return x.useEffect(()=>{var i;const s=Object.values(h);s.length>0&&m.error((i=s[0])==null?void 0:i.message,{theme:"colored",autoClose:2e3,pauseOnHover:!1})},[h]),e.jsxs("div",{children:[e.jsx(B,{children:"add new user"}),e.jsxs("form",{className:"pt-14",onSubmit:g(I),children:[e.jsx("div",{className:"w-[300px] h-[300px] mx-auto rounded-full mb-16",children:e.jsx(L,{className:"!rounded-full h-full",onChange:v,handleDeleteImage:N,progress:E,image:p,userImage:"true"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-10 mb-10",children:[e.jsxs(l,{children:[e.jsx(o,{children:"username ‚úíÔ∏è"}),e.jsx(d,{control:r,placeholder:"Enter your username",name:"username"})]}),e.jsxs(l,{children:[e.jsx(o,{children:"slug ‚úíÔ∏è"}),e.jsx(d,{control:r,placeholder:"Example: taketa-hana",name:"slug"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 mb-10 gap-x-10",children:[e.jsxs(l,{children:[e.jsx(o,{children:"email ‚úíÔ∏è"}),e.jsx(d,{control:r,placeholder:"Enter your email",name:"email"})]}),e.jsxs(l,{children:[e.jsx(o,{children:"password ‚úíÔ∏è"}),e.jsx(d,{control:r,placeholder:"Enter your title",name:"password"})]})]}),e.jsx("div",{className:"grid grid-cols-2 mb-10 gap-x-10",children:e.jsxs(l,{children:[e.jsx(o,{children:"role üìâ"}),e.jsxs("div",{className:"flex items-center gap-x-5",children:[e.jsx(c,{name:"role",control:r,checked:n===a.ADMIN,value:a.ADMIN,children:"admin"}),e.jsx(c,{name:"role",control:r,checked:n===a.MOD,value:a.MOD,children:"mod"}),e.jsx(c,{name:"role",control:r,checked:n===a.USER,value:a.USER,children:"user"})]})]})}),e.jsx($,{type:"submit",kind:"secondary",className:`w-[250px] mx-auto h-[65px] font-semibold text-xl ${u?"opacity-50 pointer-events-none":""}`,children:u?e.jsx(V,{}):"add new user"})]})]})};export{Z as default};
